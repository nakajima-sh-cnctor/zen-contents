---
title: "Vue 3ã®ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ï¼ˆComposablesï¼‰ã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ãŸ"
emoji: "ğŸ¯"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["vue", "javascript", "frontend"]
published: false
---

# Vue 3ã®ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ï¼ˆComposablesï¼‰ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã‚ˆã†

Vue 3ã®Composition APIã®æ ¸å¿ƒã¨ãªã‚‹**ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ï¼ˆComposablesï¼‰**ã«ã¤ã„ã¦ã€å®Ÿç”¨çš„ãªä¾‹ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’äº¤ãˆãªãŒã‚‰è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚

## ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã¨ã¯ï¼Ÿ

ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã¯ã€Vue 3ã®Composition APIã§ä½¿ç”¨ã•ã‚Œã‚‹é–¢æ•°ã§ã€**å†åˆ©ç”¨å¯èƒ½ãªçŠ¶æ…‹ãƒ­ã‚¸ãƒƒã‚¯**ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã—ã¾ã™ã€‚Reactã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¨ä¼¼ãŸæ¦‚å¿µã§ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…±æœ‰ã§ãã¾ã™ã€‚

### åŸºæœ¬çš„ãªã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®ä¾‹

```javascript
// useCounter.js
import { ref } from 'vue'

export function useCounter(initialValue = 0) {
  const count = ref(initialValue)
  
  const increment = () => count.value++
  const decrement = () => count.value--
  const reset = () => count.value = initialValue
  
  return {
    count,
    increment,
    decrement,
    reset
  }
}
```

```vue
<!-- Counter.vue -->
<template>
  <div>
    <p>ã‚«ã‚¦ãƒ³ãƒˆ: {{ count }}</p>
    <button @click="increment">+</button>
    <button @click="decrement">-</button>
    <button @click="reset">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>
</template>

<script setup>
import { useCounter } from './useCounter'

const { count, increment, decrement, reset } = useCounter(10)
</script>
```

## å®Ÿç”¨çš„ãªã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®ä¾‹

### 1. APIãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°

```javascript
// useApi.js
import { ref, onMounted } from 'vue'

export function useApi(url) {
  const data = ref(null)
  const loading = ref(false)
  const error = ref(null)
  
  const fetchData = async () => {
    loading.value = true
    error.value = null
    
    try {
      const response = await fetch(url)
      if (!response.ok) throw new Error('APIã‚¨ãƒ©ãƒ¼')
      data.value = await response.json()
    } catch (err) {
      error.value = err.message
    } finally {
      loading.value = false
    }
  }
  
  onMounted(fetchData)
  
  return {
    data,
    loading,
    error,
    refetch: fetchData
  }
}
```

### 2. ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç®¡ç†

```javascript
// useLocalStorage.js
import { ref, watch } from 'vue'

export function useLocalStorage(key, defaultValue) {
  const storedValue = localStorage.getItem(key)
  const value = ref(storedValue ? JSON.parse(storedValue) : defaultValue)
  
  watch(value, (newValue) => {
    localStorage.setItem(key, JSON.stringify(newValue))
  }, { deep: true })
  
  return value
}
```

### 3. ãƒã‚¦ã‚¹ä½ç½®ã®è¿½è·¡

```javascript
// useMouse.js
import { ref, onMounted, onUnmounted } from 'vue'

export function useMouse() {
  const x = ref(0)
  const y = ref(0)
  
  const updateMouse = (event) => {
    x.value = event.pageX
    y.value = event.pageY
  }
  
  onMounted(() => {
    window.addEventListener('mousemove', updateMouse)
  })
  
  onUnmounted(() => {
    window.removeEventListener('mousemove', updateMouse)
  })
  
  return { x, y }
}
```

### 4. ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```javascript
// useFormValidation.js
import { ref, computed } from 'vue'

export function useFormValidation() {
  const errors = ref({})
  const touched = ref({})
  
  const setError = (field, message) => {
    errors.value[field] = message
  }
  
  const clearError = (field) => {
    delete errors.value[field]
  }
  
  const touch = (field) => {
    touched.value[field] = true
  }
  
  const hasError = (field) => {
    return touched.value[field] && errors.value[field]
  }
  
  const isValid = computed(() => {
    return Object.keys(errors.value).length === 0
  })
  
  return {
    errors,
    touched,
    setError,
    clearError,
    touch,
    hasError,
    isValid
  }
}
```

## ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. å‘½åè¦å‰‡

- `use`ã§å§‹ã‚ã‚‹ï¼ˆä¾‹ï¼š`useCounter`, `useApi`ï¼‰
- æ©Ÿèƒ½ã‚’æ˜ç¢ºã«è¡¨ç¾ã™ã‚‹åå‰ã‚’ä»˜ã‘ã‚‹

### 2. å˜ä¸€è²¬ä»»ã®åŸå‰‡

```javascript
// âŒ æ‚ªã„ä¾‹ï¼šè¤‡æ•°ã®è²¬ä»»ã‚’æŒã¤
export function useUserAndPosts() {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã¨æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã®ä¸¡æ–¹ã‚’ç®¡ç†
}

// âœ… è‰¯ã„ä¾‹ï¼šå˜ä¸€ã®è²¬ä»»
export function useUser() {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®ã¿ã‚’ç®¡ç†
}

export function usePosts() {
  // æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’ç®¡ç†
}
```

### 3. ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æä¾›

```javascript
// useApi.js
export function useApi(url, options = {}) {
  const {
    immediate = true,
    onSuccess,
    onError
  } = options
  
  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«åŸºã¥ã„ã¦å‹•ä½œã‚’å¤‰æ›´
}
```

### 4. é©åˆ‡ãªãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†

```javascript
// useEventListener.js
import { onMounted, onUnmounted } from 'vue'

export function useEventListener(target, event, callback) {
  onMounted(() => {
    target.addEventListener(event, callback)
  })
  
  onUnmounted(() => {
    target.removeEventListener(event, callback)
  })
}
```

### 5. å‹å®‰å…¨æ€§ï¼ˆTypeScriptä½¿ç”¨æ™‚ï¼‰

```typescript
// useCounter.ts
import { ref, Ref } from 'vue'

export function useCounter(initialValue: number = 0): {
  count: Ref<number>
  increment: () => void
  decrement: () => void
  reset: () => void
} {
  const count = ref(initialValue)
  
  const increment = () => count.value++
  const decrement = () => count.value--
  const reset = () => count.value = initialValue
  
  return {
    count,
    increment,
    decrement,
    reset
  }
}
```

## ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®çµ„ã¿åˆã‚ã›

è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šè¤‡é›‘ãªæ©Ÿèƒ½ã‚’å®Ÿç¾ã§ãã¾ã™ï¼š

```vue
<template>
  <div>
    <form @submit.prevent="handleSubmit">
      <input 
        v-model="formData.email" 
        @blur="touch('email')"
        placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹"
      />
      <span v-if="hasError('email')" class="error">
        {{ errors.email }}
      </span>
      
      <button type="submit" :disabled="!isValid">
        é€ä¿¡
      </button>
    </form>
    
    <div v-if="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
    <div v-if="error" class="error">{{ error }}</div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { useFormValidation } from './useFormValidation'
import { useApi } from './useApi'

const formData = ref({
  email: ''
})

const { errors, touched, setError, clearError, touch, hasError, isValid } = useFormValidation()
const { data, loading, error, refetch } = useApi('/api/submit')

const handleSubmit = async () => {
  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  if (!formData.value.email) {
    setError('email', 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¿…é ˆã§ã™')
    return
  }
  
  // APIé€ä¿¡
  await refetch()
}
</script>
```

## ã¾ã¨ã‚

Vue 3ã®ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã¯ã€ä»¥ä¸‹ã®åˆ©ç‚¹ã‚’æä¾›ã—ã¾ã™ï¼š

- **å†åˆ©ç”¨æ€§**: è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…±æœ‰
- **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£**: ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½
- **å¯èª­æ€§**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ­ã‚¸ãƒƒã‚¯ãŒæ•´ç†ã•ã‚Œã‚‹
- **å‹å®‰å…¨æ€§**: TypeScriptã¨ã®ç›¸æ€§ãŒè‰¯ã„

ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šä¿å®ˆæ€§ãŒé«˜ãã€å†åˆ©ç”¨å¯èƒ½ãªVueã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚ã¾ãšã¯ç°¡å˜ãªä¾‹ã‹ã‚‰å§‹ã‚ã¦ã€å¾ã€…ã«è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«åŒ–ã—ã¦ã„ãã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚

## å‚è€ƒãƒªãƒ³ã‚¯

- [Vue 3 Composition APIå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vuejs.org/guide/reusability/composables.html)
- [VueUse](https://vueuse.org/) - å®Ÿç”¨çš„ãªã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
