---
title: "Nuxt3ã¨Firebaseã§ã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ’¬"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nuxt3", "firebase", "vue3", "typescript", "pinia"]
published: false
---

## ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã§ã¯ã€Nuxt3ã¨Firebaseã‚’ä½¿ç”¨ã—ã¦ã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚Vue 3ã®Composition APIã€Piniaã‚¹ãƒˆã‚¢ã€Vuetify UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ´»ç”¨ã—ãŸå®Ÿè£…ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## å®Ÿè£…ã®æ¦‚è¦

ã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆæ©Ÿèƒ½ã¯ä»¥ä¸‹ã®è¦ç´ ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

- **ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** (`app/pages/thread/create.vue`)
- **ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** (`app/components/ThreadForm.vue`)
- **ã‚¹ãƒˆã‚¢** (`app/stores/thread.ts`)

## 1. ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…

```vue
<script setup lang="ts">
const { createThread } = useThreadStore()
const error = ref('')

const handleSubmit = async (data: { title: string; description: string }) => {
  const { error: threadError } = await createThread(
    data.title,
    data.description
  )

  if (threadError) {
    error.value = threadError.message
    return
  }
  await navigateTo('/thread')
}
</script>

<template>
  <v-card class="mx-auto" max-width="600">
    <v-card-item>
      <v-card-title> ã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆ </v-card-title>
    </v-card-item>
    <v-card-item>
      <v-alert
        v-if="error"
        type="error"
        :text="error"
        variant="tonal"
        class="mb-4"
      />
      <ThreadForm @submit="handleSubmit" />
    </v-card-item>
  </v-card>
</template>
```

### ãƒã‚¤ãƒ³ãƒˆ

- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆæ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ã‚¢ãƒ©ãƒ¼ãƒˆã§è¡¨ç¤º
- **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ä½œæˆæˆåŠŸå¾Œã¯è‡ªå‹•çš„ã«ã‚¹ãƒ¬ãƒƒãƒ‰ä¸€è¦§ãƒšãƒ¼ã‚¸ã«é·ç§»
- **UI**: Vuetifyã®ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ€ãƒ³ãªãƒ‡ã‚¶ã‚¤ãƒ³

## 2. ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…

```vue
<script setup lang="ts">
const form = ref()
const title = ref('')
const description = ref('')

const titleRules = [(v: string) => !!v || 'ã‚¿ã‚¤ãƒˆãƒ«ã¯å¿…é ˆã§ã™']
const descriptionRules = [(v: string) => !!v || 'æ¦‚è¦ã¯å¿…é ˆã§ã™']

const emit = defineEmits<{
  submit: [data: { title: string; description: string }]
}>()

const submit = async () => {
  const { valid } = await form.value.validate()
  if (valid) {
    emit('submit', {
      title: title.value,
      description: description.value,
    })
  }
}
</script>

<template>
  <v-form ref="form" @submit.prevent="submit">
    <v-text-field
      v-model="title"
      label="ã‚¿ã‚¤ãƒˆãƒ«"
      variant="underlined"
      :rules="titleRules"
      required
    />

    <v-textarea
      v-model="description"
      label="æ¦‚è¦"
      variant="underlined"
      :rules="descriptionRules"
      required
      rows="4"
    />

    <v-btn color="primary" class="mt-4" block type="submit">ä½œæˆ</v-btn>
  </v-form>
</template>
```

### ãƒã‚¤ãƒ³ãƒˆ

- **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: ã‚¿ã‚¤ãƒˆãƒ«ã¨æ¦‚è¦ã®å¿…é ˆãƒã‚§ãƒƒã‚¯
- **ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«**: è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«submitã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
- **UI**: Vuetifyã®ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§çµ±ä¸€æ„Ÿã®ã‚ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³

## 3. ã‚¹ãƒˆã‚¢ã®å®Ÿè£…

```typescript
export interface Thread {
  id: string
  title: string
  description: string
  authorId: string
  authorName: string
  createdAt: Date
  updatedAt: Date
}

export const useThreadStore = defineStore('thread', () => {
  const { $firestore } = useNuxtApp()
  const firestore = $firestore as Firestore | null
  const threads = ref<Thread[]>([])
  const loading = ref(false)

  // ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½œæˆ
  const createThread = async (title: string, description: string) => {
    if (!firestore) {
      return {
        thread: null,
        error: new Error('FirestoreãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“'),
      }
    }

    const authStore = useAuthStore()
    const profileStore = useProfileStore()

    if (!authStore.user || !profileStore.profile) {
      return {
        thread: null,
        error: new Error(
          'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèªè¨¼ã•ã‚Œã¦ã„ãªã„ã‹ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“'
        ),
      }
    }

    loading.value = true
    try {
      const threadData = {
        title,
        description,
        authorId: authStore.user.uid,
        authorName: profileStore.profile.nickname,
        createdAt: serverTimestamp(),
        updatedAt: serverTimestamp(),
      }

      const docRef = await addDoc(collection(firestore, 'threads'), threadData)

      const newThread: Thread = {
        id: docRef.id,
        ...threadData,
        createdAt: new Date(),
        updatedAt: new Date(),
      }

      threads.value.unshift(newThread)

      return { thread: newThread, error: null }
    } catch (error) {
      return { thread: null, error: error as Error }
    } finally {
      loading.value = false
    }
  }

  return {
    threads,
    loading,
    createThread,
    getThreads,
  }
})
```

### ãƒã‚¤ãƒ³ãƒˆ

- **å‹å®‰å…¨æ€§**: TypeScriptã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å„æ®µéšã§ã®ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã¨é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- **èªè¨¼ãƒã‚§ãƒƒã‚¯**: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã®ç¢ºèª
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**: ä½œæˆå¾Œã™ãã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆã‚¢ã‚’æ›´æ–°

## 4. å®Ÿè£…ã®æµã‚Œ

1. **ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¿ã‚¤ãƒˆãƒ«ã¨æ¦‚è¦ã‚’å…¥åŠ›
2. **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: å¿…é ˆé …ç›®ã®ãƒã‚§ãƒƒã‚¯
3. **èªè¨¼ç¢ºèª**: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã®ç¢ºèª
4. **Firestoreä¿å­˜**: ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’Firestoreã«ä¿å­˜
5. **ãƒ­ãƒ¼ã‚«ãƒ«æ›´æ–°**: ã‚¹ãƒˆã‚¢ã®çŠ¶æ…‹ã‚’æ›´æ–°
6. **ç”»é¢é·ç§»**: ã‚¹ãƒ¬ãƒƒãƒ‰ä¸€è¦§ãƒšãƒ¼ã‚¸ã«é·ç§»

## 5. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Nuxt3, Vue 3, TypeScript
- **UI**: Vuetify 3
- **çŠ¶æ…‹ç®¡ç†**: Pinia
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Firebase Firestore
- **èªè¨¼**: Firebase Authentication

## ã¾ã¨ã‚

ã“ã®å®Ÿè£…ã§ã¯ã€ãƒ¢ãƒ€ãƒ³ãªVue.jsã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆæ©Ÿèƒ½ã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚å‹å®‰å…¨æ€§ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€UI/UXã®è¦³ç‚¹ã‹ã‚‰ã€å®Ÿç”¨çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿…è¦ãªè¦ç´ ã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚

ç‰¹ã«ã€Composition APIã¨Piniaã‚¹ãƒˆã‚¢ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚Šã€ä¿å®ˆæ€§ã®é«˜ã„ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿç¾ã—ã¦ãŠã‚Šã€ä»Šå¾Œã®æ©Ÿèƒ½æ‹¡å¼µã«ã‚‚å¯¾å¿œã—ã‚„ã™ã„æ§‹é€ ã«ãªã£ã¦ã„ã¾ã™ã€‚
