---
title: "Vue 3ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ã¾ã—ãŸ"
emoji: "ğŸ”Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["vue", "javascript", "frontend", "plugin"]
published: false
---

# Vue 3ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™º

Vue 3ã®**ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**ã«ã¤ã„ã¦ã€å®Ÿç”¨çš„ãªä¾‹ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’äº¤ãˆãªãŒã‚‰è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€å†åˆ©ç”¨å¯èƒ½ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã¯ï¼Ÿ

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€Vueã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«**ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªæ©Ÿèƒ½**ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã§ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æä¾›ã§ãã¾ã™ï¼š

- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¿½åŠ 
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ã®è¿½åŠ 
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ³¨å…¥
- ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¢ã‚»ãƒƒãƒˆã®è¿½åŠ 
- å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®çµ±åˆ

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®åŸºæœ¬æ§‹é€ 

Vue 3ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€`install`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¾ãŸã¯é–¢æ•°ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™ï¼š

```javascript
// ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼
const MyPlugin = {
  install(app, options) {
    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å®Ÿè£…
  }
}

// é–¢æ•°å½¢å¼
function MyPlugin(app, options) {
  // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å®Ÿè£…
}
```

## åŸºæœ¬çš„ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä¾‹

### 1. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿½åŠ 

```javascript
// plugins/globalMethods.js
export const GlobalMethodsPlugin = {
  install(app) {
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿½åŠ 
    app.config.globalProperties.$formatDate = (date) => {
      return new Date(date).toLocaleDateString('ja-JP')
    }
    
    app.config.globalProperties.$formatCurrency = (amount) => {
      return new Intl.NumberFormat('ja-JP', {
        style: 'currency',
        currency: 'JPY'
      }).format(amount)
    }
  }
}
```

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import { GlobalMethodsPlugin } from './plugins/globalMethods'

const app = createApp(App)
app.use(GlobalMethodsPlugin)
app.mount('#app')
```

```vue
<!-- App.vue -->
<template>
  <div>
    <p>æ—¥ä»˜: {{ $formatDate(new Date()) }}</p>
    <p>ä¾¡æ ¼: {{ $formatCurrency(1000) }}</p>
  </div>
</template>
```

### 2. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¿½åŠ 

```javascript
// plugins/globalProperties.js
export const GlobalPropertiesPlugin = {
  install(app) {
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¿½åŠ 
    app.config.globalProperties.$appName = 'My Vue App'
    app.config.globalProperties.$version = '1.0.0'
    app.config.globalProperties.$apiUrl = 'https://api.example.com'
  }
}
```

```vue
<template>
  <div>
    <h1>{{ $appName }} v{{ $version }}</h1>
    <p>API URL: {{ $apiUrl }}</p>
  </div>
</template>
```

### 3. ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®è¿½åŠ 

```javascript
// plugins/directives.js
export const DirectivesPlugin = {
  install(app) {
    // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–
    app.directive('focus', {
      mounted(el) {
        el.focus()
      }
    })
    
    // è‰²å¤‰æ›´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–
    app.directive('color', {
      mounted(el, binding) {
        el.style.color = binding.value
      },
      updated(el, binding) {
        el.style.color = binding.value
      }
    })
  }
}
```

```vue
<template>
  <div>
    <input v-focus placeholder="è‡ªå‹•ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹" />
    <p v-color="'red'">èµ¤ã„ãƒ†ã‚­ã‚¹ãƒˆ</p>
  </div>
</template>
```

## å®Ÿç”¨çš„ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä¾‹

### 1. HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³

```javascript
// plugins/http.js
class HttpClient {
  constructor(baseURL = '') {
    this.baseURL = baseURL
    this.interceptors = {
      request: [],
      response: []
    }
  }
  
  addRequestInterceptor(interceptor) {
    this.interceptors.request.push(interceptor)
  }
  
  addResponseInterceptor(interceptor) {
    this.interceptors.response.push(interceptor)
  }
  
  async request(url, options = {}) {
    let requestConfig = {
      url: this.baseURL + url,
      ...options
    }
    
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã‚’é©ç”¨
    for (const interceptor of this.interceptors.request) {
      requestConfig = await interceptor(requestConfig)
    }
    
    try {
      const response = await fetch(requestConfig.url, {
        method: requestConfig.method || 'GET',
        headers: {
          'Content-Type': 'application/json',
          ...requestConfig.headers
        },
        body: requestConfig.body ? JSON.stringify(requestConfig.body) : undefined
      })
      
      let responseData = await response.json()
      
      // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã‚’é©ç”¨
      for (const interceptor of this.interceptors.response) {
        responseData = await interceptor(responseData)
      }
      
      return responseData
    } catch (error) {
      throw error
    }
  }
  
  get(url, options = {}) {
    return this.request(url, { ...options, method: 'GET' })
  }
  
  post(url, data, options = {}) {
    return this.request(url, { ...options, method: 'POST', body: data })
  }
  
  put(url, data, options = {}) {
    return this.request(url, { ...options, method: 'PUT', body: data })
  }
  
  delete(url, options = {}) {
    return this.request(url, { ...options, method: 'DELETE' })
  }
}

export const HttpPlugin = {
  install(app, options = {}) {
    const http = new HttpClient(options.baseURL)
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦è¿½åŠ 
    app.config.globalProperties.$http = http
    
    // provide/injectç”¨ã«æä¾›
    app.provide('http', http)
    
    // ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã®è¨­å®š
    if (options.interceptors) {
      if (options.interceptors.request) {
        http.addRequestInterceptor(options.interceptors.request)
      }
      if (options.interceptors.response) {
        http.addResponseInterceptor(options.interceptors.response)
      }
    }
  }
}
```

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import { HttpPlugin } from './plugins/http'

const app = createApp(App)

app.use(HttpPlugin, {
  baseURL: 'https://api.example.com',
  interceptors: {
    request: async (config) => {
      // èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¿½åŠ 
      const token = localStorage.getItem('token')
      if (token) {
        config.headers = {
          ...config.headers,
          'Authorization': `Bearer ${token}`
        }
      }
      return config
    },
    response: async (data) => {
      // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‡¦ç†
      console.log('Response:', data)
      return data
    }
  }
})

app.mount('#app')
```

```vue
<!-- App.vue -->
<template>
  <div>
    <button @click="fetchUsers">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—</button>
    <button @click="createUser">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ</button>
    <div v-if="users.length">
      <ul>
        <li v-for="user in users" :key="user.id">
          {{ user.name }}
        </li>
      </ul>
    </div>
  </div>
</template>

<script setup>
import { ref, inject } from 'vue'

const http = inject('http')
const users = ref([])

const fetchUsers = async () => {
  try {
    users.value = await http.get('/users')
  } catch (error) {
    console.error('ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼:', error)
  }
}

const createUser = async () => {
  try {
    const newUser = await http.post('/users', {
      name: 'æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼',
      email: 'user@example.com'
    })
    users.value.push(newUser)
  } catch (error) {
    console.error('ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚¨ãƒ©ãƒ¼:', error)
  }
}
</script>
```

### 2. çŠ¶æ…‹ç®¡ç†ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

```javascript
// plugins/store.js
class SimpleStore {
  constructor() {
    this.state = {}
    this.subscribers = []
  }
  
  setState(newState) {
    this.state = { ...this.state, ...newState }
    this.notifySubscribers()
  }
  
  getState() {
    return this.state
  }
  
  subscribe(callback) {
    this.subscribers.push(callback)
    return () => {
      const index = this.subscribers.indexOf(callback)
      if (index > -1) {
        this.subscribers.splice(index, 1)
      }
    }
  }
  
  notifySubscribers() {
    this.subscribers.forEach(callback => callback(this.state))
  }
}

export const StorePlugin = {
  install(app, options = {}) {
    const store = new SimpleStore()
    
    // åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
    if (options.initialState) {
      store.setState(options.initialState)
    }
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦è¿½åŠ 
    app.config.globalProperties.$store = store
    
    // provide/injectç”¨ã«æä¾›
    app.provide('store', store)
  }
}
```

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import { StorePlugin } from './plugins/store'

const app = createApp(App)

app.use(StorePlugin, {
  initialState: {
    user: null,
    theme: 'light',
    notifications: []
  }
})

app.mount('#app')
```

```vue
<!-- App.vue -->
<template>
  <div :class="theme">
    <h1>Vue Store Plugin</h1>
    <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼: {{ user?.name || 'æœªãƒ­ã‚°ã‚¤ãƒ³' }}</p>
    <p>ãƒ†ãƒ¼ãƒ: {{ theme }}</p>
    <button @click="toggleTheme">ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ</button>
    <button @click="login">ãƒ­ã‚°ã‚¤ãƒ³</button>
  </div>
</template>

<script setup>
import { computed, inject } from 'vue'

const store = inject('store')

const user = computed(() => store.getState().user)
const theme = computed(() => store.getState().theme)

const toggleTheme = () => {
  const newTheme = theme.value === 'light' ? 'dark' : 'light'
  store.setState({ theme: newTheme })
}

const login = () => {
  store.setState({
    user: { name: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼', email: 'test@example.com' }
  })
}
</script>

<style>
.light {
  background-color: white;
  color: black;
}

.dark {
  background-color: black;
  color: white;
}
</style>
```

### 3. UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³

```javascript
// plugins/ui.js
import Toast from './components/Toast.vue'
import Modal from './components/Modal.vue'
import Loading from './components/Loading.vue'

export const UIPlugin = {
  install(app) {
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ç™»éŒ²
    app.component('Toast', Toast)
    app.component('Modal', Modal)
    app.component('Loading', Loading)
    
    // ãƒˆãƒ¼ã‚¹ãƒˆæ©Ÿèƒ½ã®è¿½åŠ 
    app.config.globalProperties.$toast = {
      success(message) {
        // ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤ºã®å®Ÿè£…
        console.log('Success:', message)
      },
      error(message) {
        console.log('Error:', message)
      },
      info(message) {
        console.log('Info:', message)
      }
    }
    
    // ãƒ¢ãƒ¼ãƒ€ãƒ«æ©Ÿèƒ½ã®è¿½åŠ 
    app.config.globalProperties.$modal = {
      show(component, props = {}) {
        // ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºã®å®Ÿè£…
        console.log('Modal show:', component, props)
      },
      hide() {
        console.log('Modal hide')
      }
    }
  }
}
```

```vue
<!-- components/Toast.vue -->
<template>
  <div v-if="visible" class="toast" :class="type">
    {{ message }}
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'

const props = defineProps({
  message: String,
  type: {
    type: String,
    default: 'info'
  },
  duration: {
    type: Number,
    default: 3000
  }
})

const visible = ref(false)

onMounted(() => {
  visible.value = true
  setTimeout(() => {
    visible.value = false
  }, props.duration)
})
</script>

<style>
.toast {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 12px 16px;
  border-radius: 4px;
  color: white;
  z-index: 1000;
}

.toast.success {
  background-color: #4caf50;
}

.toast.error {
  background-color: #f44336;
}

.toast.info {
  background-color: #2196f3;
}
</style>
```

```vue
<!-- App.vue -->
<template>
  <div>
    <h1>UI Plugin Demo</h1>
    <button @click="showSuccessToast">æˆåŠŸãƒˆãƒ¼ã‚¹ãƒˆ</button>
    <button @click="showErrorToast">ã‚¨ãƒ©ãƒ¼ãƒˆãƒ¼ã‚¹ãƒˆ</button>
    <button @click="showModal">ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º</button>
    
    <!-- ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½¿ç”¨ -->
    <Toast message="ãƒ†ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸" type="info" />
  </div>
</template>

<script setup>
import { getCurrentInstance } from 'vue'

const instance = getCurrentInstance()

const showSuccessToast = () => {
  instance.proxy.$toast.success('æ“ä½œãŒæˆåŠŸã—ã¾ã—ãŸï¼')
}

const showErrorToast = () => {
  instance.proxy.$toast.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ')
}

const showModal = () => {
  instance.proxy.$modal.show('UserModal', { userId: 123 })
}
</script>
```

### 4. ãƒ­ã‚°ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

```javascript
// plugins/logger.js
class Logger {
  constructor(options = {}) {
    this.level = options.level || 'info'
    this.enabled = options.enabled !== false
    this.levels = {
      error: 0,
      warn: 1,
      info: 2,
      debug: 3
    }
  }
  
  log(level, message, ...args) {
    if (!this.enabled || this.levels[level] > this.levels[this.level]) {
      return
    }
    
    const timestamp = new Date().toISOString()
    const prefix = `[${timestamp}] [${level.toUpperCase()}]`
    
    switch (level) {
      case 'error':
        console.error(prefix, message, ...args)
        break
      case 'warn':
        console.warn(prefix, message, ...args)
        break
      case 'info':
        console.info(prefix, message, ...args)
        break
      case 'debug':
        console.debug(prefix, message, ...args)
        break
      default:
        console.log(prefix, message, ...args)
    }
  }
  
  error(message, ...args) {
    this.log('error', message, ...args)
  }
  
  warn(message, ...args) {
    this.log('warn', message, ...args)
  }
  
  info(message, ...args) {
    this.log('info', message, ...args)
  }
  
  debug(message, ...args) {
    this.log('debug', message, ...args)
  }
}

export const LoggerPlugin = {
  install(app, options = {}) {
    const logger = new Logger(options)
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦è¿½åŠ 
    app.config.globalProperties.$logger = logger
    
    // provide/injectç”¨ã«æä¾›
    app.provide('logger', logger)
  }
}
```

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import { LoggerPlugin } from './plugins/logger'

const app = createApp(App)

app.use(LoggerPlugin, {
  level: 'debug',
  enabled: process.env.NODE_ENV !== 'production'
})

app.mount('#app')
```

```vue
<!-- App.vue -->
<template>
  <div>
    <h1>Logger Plugin Demo</h1>
    <button @click="testLogs">ãƒ­ã‚°ã‚’ãƒ†ã‚¹ãƒˆ</button>
  </div>
</template>

<script setup>
import { inject } from 'vue'

const logger = inject('logger')

const testLogs = () => {
  logger.debug('ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸')
  logger.info('æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸')
  logger.warn('è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸')
  logger.error('ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸')
}
</script>
```

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®é…å¸ƒã¨TypeScriptå¯¾å¿œ

### 1. npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦é…å¸ƒ

```json
// package.json
{
  "name": "vue3-my-plugin",
  "version": "1.0.0",
  "description": "My Vue 3 Plugin",
  "main": "dist/index.js",
  "module": "dist/index.esm.js",
  "types": "dist/index.d.ts",
  "files": [
    "dist"
  ],
  "scripts": {
    "build": "rollup -c",
    "dev": "rollup -c -w"
  },
  "peerDependencies": {
    "vue": "^3.0.0"
  },
  "devDependencies": {
    "@rollup/plugin-typescript": "^8.0.0",
    "rollup": "^2.0.0",
    "typescript": "^4.0.0"
  }
}
```

```typescript
// src/index.ts
import { App } from 'vue'

export interface PluginOptions {
  baseURL?: string
  timeout?: number
  retries?: number
}

export interface MyPlugin {
  install(app: App, options?: PluginOptions): void
}

declare module '@vue/runtime-core' {
  interface ComponentCustomProperties {
    $myPlugin: any
  }
}

const MyPlugin: MyPlugin = {
  install(app: App, options: PluginOptions = {}) {
    const config = {
      baseURL: options.baseURL || '',
      timeout: options.timeout || 5000,
      retries: options.retries || 3
    }
    
    app.config.globalProperties.$myPlugin = {
      config,
      // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æ©Ÿèƒ½
    }
  }
}

export default MyPlugin
```

```typescript
// src/types.ts
export interface User {
  id: number
  name: string
  email: string
}

export interface ApiResponse<T> {
  data: T
  status: number
  message: string
}
```

### 2. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½¿ç”¨ä¾‹ï¼ˆTypeScriptï¼‰

```typescript
// main.ts
import { createApp } from 'vue'
import App from './App.vue'
import MyPlugin, { PluginOptions } from 'vue3-my-plugin'

const app = createApp(App)

const options: PluginOptions = {
  baseURL: 'https://api.example.com',
  timeout: 10000,
  retries: 5
}

app.use(MyPlugin, options)
app.mount('#app')
```

```vue
<!-- App.vue -->
<template>
  <div>
    <h1>My Plugin Demo</h1>
    <button @click="usePlugin">ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨</button>
  </div>
</template>

<script setup lang="ts">
import { getCurrentInstance } from 'vue'

const instance = getCurrentInstance()

const usePlugin = () => {
  // TypeScriptã§å‹å®‰å…¨ã«ä½¿ç”¨
  const plugin = instance?.proxy?.$myPlugin
  if (plugin) {
    console.log('Plugin config:', plugin.config)
  }
}
</script>
```

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¨­è¨ˆåŸå‰‡

```javascript
// âœ… è‰¯ã„ä¾‹ï¼šå˜ä¸€è²¬ä»»ã®åŸå‰‡
export const ValidationPlugin = {
  install(app, options) {
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã®ã¿ã«é›†ä¸­
    app.config.globalProperties.$validate = {
      email: (email) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email),
      required: (value) => value != null && value !== '',
      minLength: (value, min) => value.length >= min
    }
  }
}

// âŒ æ‚ªã„ä¾‹ï¼šè¤‡æ•°ã®è²¬ä»»ã‚’æŒã¤
export const BadPlugin = {
  install(app, options) {
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€HTTPã€ãƒ­ã‚°ãªã©è¤‡æ•°ã®æ©Ÿèƒ½ã‚’æ··åœ¨
    app.config.globalProperties.$validate = { /* ... */ }
    app.config.globalProperties.$http = { /* ... */ }
    app.config.globalProperties.$logger = { /* ... */ }
  }
}
```

### 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```javascript
export const SafePlugin = {
  install(app, options = {}) {
    try {
      // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®åˆæœŸåŒ–
      const config = this.validateOptions(options)
      this.initializePlugin(app, config)
    } catch (error) {
      console.error('Plugin initialization failed:', error)
      // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
      this.initializeFallback(app)
    }
  },
  
  validateOptions(options) {
    if (!options.requiredOption) {
      throw new Error('requiredOption is required')
    }
    return options
  },
  
  initializePlugin(app, config) {
    // ãƒ¡ã‚¤ãƒ³ã®åˆæœŸåŒ–å‡¦ç†
  },
  
  initializeFallback(app) {
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
  }
}
```

### 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è€ƒæ…®

```javascript
export const PerformancePlugin = {
  install(app, options) {
    // é…å»¶åˆæœŸåŒ–
    let initialized = false
    
    app.config.globalProperties.$lazyFeature = () => {
      if (!initialized) {
        this.initializeHeavyFeature()
        initialized = true
      }
      return this.heavyFeature
    }
  },
  
  initializeHeavyFeature() {
    // é‡ã„å‡¦ç†ã¯å¿…è¦ã«ãªã£ãŸæ™‚ã®ã¿å®Ÿè¡Œ
  }
}
```

### 4. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ãƒ†ã‚¹ãƒˆ

```javascript
// plugins/__tests__/myPlugin.test.js
import { createApp } from 'vue'
import MyPlugin from '../myPlugin'

describe('MyPlugin', () => {
  let app
  
  beforeEach(() => {
    app = createApp({})
  })
  
  test('should install plugin correctly', () => {
    app.use(MyPlugin, { testOption: 'test' })
    
    expect(app.config.globalProperties.$myPlugin).toBeDefined()
  })
  
  test('should handle options correctly', () => {
    const options = { baseURL: 'https://test.com' }
    app.use(MyPlugin, options)
    
    const plugin = app.config.globalProperties.$myPlugin
    expect(plugin.config.baseURL).toBe('https://test.com')
  })
})
```

## ã¾ã¨ã‚

Vue 3ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€ä»¥ä¸‹ã®åˆ©ç‚¹ã‚’æä¾›ã—ã¾ã™ï¼š

- **æ©Ÿèƒ½ã®æ‹¡å¼µ**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã«æ©Ÿèƒ½ã‚’è¿½åŠ 
- **å†åˆ©ç”¨æ€§**: è¤‡æ•°ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åŒã˜æ©Ÿèƒ½ã‚’å…±æœ‰
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ€§**: æ©Ÿèƒ½ã‚’ç‹¬ç«‹ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ç®¡ç†
- **çµ±åˆæ€§**: ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®çµ±åˆãŒå®¹æ˜“

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’é©åˆ‡ã«è¨­è¨ˆãƒ»å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ä¿å®ˆæ€§ãŒé«˜ãã€æ‹¡å¼µæ€§ã®ã‚ã‚‹Vueã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚ãŸã ã—ã€éåº¦ãªã‚°ãƒ­ãƒ¼ãƒãƒ«æ±šæŸ“ã¯é¿ã‘ã€é©åˆ‡ãªã‚¹ã‚³ãƒ¼ãƒ—ã§æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

## å‚è€ƒãƒªãƒ³ã‚¯

- [Vue 3 ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vuejs.org/guide/reusability/plugins.html)
- [VueUse](https://vueuse.org/) - å®Ÿç”¨çš„ãªVue 3ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
- [Vue 3 Plugin Development Guide](https://vuejs.org/guide/reusability/plugins.html)
